##Дз по ШАД бд

###Схема

Создаем таблицу с четырмя полями и две вьюхи на нее. Делаем id счетчиком (SERIAL).

###1

Просто сохраняем запись в базу.

###2

Просто переподвесить нельзя, тк иначе может возникнуть проблема, когда подвешиваем себя в ребенка. Для этого случая ребенок берет прошлого родителя исходного человека. таким образом избежим зацикливания при нашей операции.

###3

Просто делаем два селекта в базу.

###4

Возвращаем нужные айдишники из второй вьюхи.

###5

Возвращаем подсчитаную в первой вьюхе строку.

###6

Рекурсивно набираем айдишники, возвращаем количество.

###7

Проверяем сначала на количество корней, потом для каждого человека пытаемя подняться на max_nodes шагов вверх по графу. Для дерева через такое количество шагов гарантированно придем в -1, для циклического графа найдется вершина из цикла, для которой мы зациклимся.

###8 

Возвращаем ранг, насчитаный в первой вьюхе.

###9

Создаем условный стек. Изначально кладем туда всех первого ранга (с родителем -1). Вытаскиваем вершину, кладем в стек всех ее детей. Так же храним стек отступов, обновляем аналогично. Для детей увеличиваем отступ и кладем его по их количеству.

###10

Определяем того, кто ниже по рангу, поднимаемся им до ранга вторго. потом одновременно идем вверх по дереву, пока не встретили одинакового человека. Он и будет общим предком. По пути запоминаем всех, кого прошли.


Для каждогой функции написано по вызову, чтбы проверить что минимально работает.
